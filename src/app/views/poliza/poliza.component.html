<div class="card container-fluid">

  <div class="text-center">
    <h1>Consulta de Pólizas</h1>
  </div>
  <!-- <div class="text-center">
    <h3>Ingrese Datos de la Póliza</h3>
  </div> -->

    <mat-stepper [linear]="isLinear" #stepper>
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup">
        <ng-template matStepLabel>Selección de Póliza</ng-template>

        <mat-form-field class="mat-form-field-lg">
          <mat-label>Buscar</mat-label>
          <input matInput (keyup)="applyFilter($event)" #input>
        </mat-form-field>
        
        <div class="mat-elevation-z8">
          <table mat-table [dataSource]="dataSource">
            
            <ng-container matColumnDef="select">
              <th mat-header-cell *matHeaderCellDef>
                <mat-checkbox (change)="$event ? masterToggle(null) : null"
                              [checked]="selection.hasValue() && isAllSelected()"
                              [indeterminate]="selection.hasValue() && !isAllSelected()">
                </mat-checkbox>
              </th>
              <td mat-cell *matCellDef="let row">
                <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? masterToggle(row) : null"
                              [checked]="selection.isSelected(row)">
                </mat-checkbox>
              </td>
            </ng-container>

            <!-- Position Column -->
            <ng-container matColumnDef="Nro_Poliza">
              <th mat-header-cell *matHeaderCellDef> Póliza </th>
              <td mat-cell *matCellDef="let element"> {{element.Nro_Poliza}}
              </td>
            </ng-container>
            <!-- Name Column -->
            <ng-container matColumnDef="Descripcion_Ramo">
              <th mat-header-cell *matHeaderCellDef> Ramo </th>
              <td mat-cell *matCellDef="let element">
                {{element.Descripcion_Ramo}} </td>
            </ng-container>
            <ng-container matColumnDef="Intermediario">
              <th mat-header-cell *matHeaderCellDef> Intermediario </th>
              <td mat-cell *matCellDef="let element"> {{element.Intermediario}}
              </td>
            </ng-container>
            <ng-container matColumnDef="Dias_de_vigencia">
              <th mat-header-cell *matHeaderCellDef> Vigencia </th>
              <td mat-cell *matCellDef="let element">
                {{element.Dias_de_vigencia}} Días</td>
            </ng-container>
            <ng-container matColumnDef="Nombre_Asegurado">
              <th mat-header-cell *matHeaderCellDef> Asegurado </th>
              <td mat-cell *matCellDef="let element">
                {{element.Nombre_Asegurado}} </td>
            </ng-container>

            <ng-container matColumnDef="Id_Asegurado">
              <th mat-header-cell *matHeaderCellDef> Identificación </th>
              <td mat-cell *matCellDef="let element"> {{element.Id_Asegurado}}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
          <br>
          <mat-paginator [pageSizeOptions]="[5, 10, 25, 50, 100]"
            showFirstLastButtons
            aria-label="Seleccione página">
          </mat-paginator>
        </div>

        <br>
        <div>
          <button class="align-right-button" mat-flat-button color="primary" mat-button matStepperNext (click)="pruebaDialog()"> 
            Siguiente
          </button>
        </div>
      </form>
    </mat-step>

    <mat-step [stepControl]="secondFormGroup" label="Información de la Póliza">
      <form [formGroup]="secondFormGroup">

        <mat-form-field style="font-size: 0.9rem;" class="peq">
          <mat-label>C.I. Tomador:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #ciTomadorInput
              readonly>
          </span>
        </mat-form-field>
        
        <mat-form-field style="font-size: 0.9rem;" class="peq">
          <mat-label>Tomador:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #tomadorInput
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="peq">
          <mat-label>C.I. Asegurado:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #ciAseguradoInput
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="peq">
          <mat-label>Asegurado:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #nombreAseguradoInput
              readonly>
          </span>
        </mat-form-field>
        
        <mat-form-field style="font-size: 0.9rem;" class="peq">
          <mat-label>C.I. Beneficiario:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #ciBeneficiarioInput
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="peq">
          <mat-label>Beneficiario:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #nombreBeneficiarioInput
              readonly>
          </span>
        </mat-form-field>

        
          <mat-form-field style="font-size: 1rem;" class="poliza">
            <mat-label>Nro. Póliza:</mat-label>
            <span class="readonly-input">
              <input matInput 
              #nroPolizaInput 
              readonly>
            </span>
          </mat-form-field>

          <mat-form-field style="font-size: 0.9rem;" class="vigencia">
            <mat-label>Vigencia:</mat-label>
            <span class="readonly-input">
              <input matInput 
                #Vigencia
                readonly>
            </span>
          </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="fechas">
          <mat-label>Fecha desde Póliza:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #FechaDesdePol
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="fechas">
          <mat-label>Fecha hasta Póliza:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #FechaHastaPol
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;">
          <mat-label>Descripción del Ramo:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #descripcionRamo
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="sucursal">
          <mat-label>Sucursal:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Sucursal
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="maspeq">
          <mat-label>Productor:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Productor
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="maspeq">
          <mat-label>Tasa:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Tasa
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="intermediario">
          <mat-label>Intermediario:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Intermediario
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="maspeq">
          <mat-label>Moneda:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Moneda
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="maspeq">
          <mat-label>Renovacion:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Tipo_Renovacion
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="maspeq">
          <mat-label>Estatus Poliza:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Estatus_Poliza
              readonly>
          </span>
        </mat-form-field>
        
        
        <mat-form-field style="font-size: 0.9rem;" class="emision">
          <mat-label>Fecha de Emisión:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Fecha_Emision
              readonly>
          </span>
        </mat-form-field>

        <mat-form-field style="font-size: 0.9rem;" class="maspeq">
          <mat-label>Plan:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Plan
              readonly>
          </span>
        </mat-form-field>
        
        <!-- <mat-form-field style="font-size: 0.9rem;" class="descripcion_plan">
          <mat-label>Descripción Plan:</mat-label>
          <span class="readonly-input">
            <input matInput 
              #Descripcion_Plan
              readonly>
          </span>
        </mat-form-field> -->

        

        <mat-form-field style="font-size: 1rem;" class="totalwidth">
          <mat-label>Observaciones:</mat-label>
          <textarea matInput 
          #Observacion
          readonly>
          </textarea>
        </mat-form-field>

        <div>
          <button *ngIf="showButton" 
                    (click)="buscarReporte()"
                    [disabled]="!showButton" mat-raised-button
                    class="mat-raised-button"
                    style="color: #fff; background-color: #db2a13fb;"
                    >Cuadro Póliza
          </button>
          <button class="align-right-button" mat-flat-button color = "primary" mat-button matStepperNext>Siguiente</button>
          <button class="align-right-button" mat-flat-button color = "warn" mat-button matStepperPrevious>Regresar</button>
        </div>
      </form>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Recibos Asociados</ng-template>
      <div>
        
        
        <div class="mat-elevation-z8">
          <br>
          <table mat-table [dataSource]="recibosData">
            <!-- Position Column -->
            <ng-container matColumnDef="cnrecibo">
              <th mat-header-cell *matHeaderCellDef> No. Recibo </th>
              <td mat-cell *matCellDef="let element"> {{element.cnrecibo}}
              </td>
            </ng-container>
            <!-- Name Column -->
            <ng-container matColumnDef="Cuotas">
              <th mat-header-cell *matHeaderCellDef> Cuotas </th>
              <td mat-cell *matCellDef="let element">
                {{element.Cuotas}} </td>
            </ng-container>
            <ng-container matColumnDef="Fecha_desde_Rec">
              <th mat-header-cell *matHeaderCellDef> Fecha desde Recibo </th>
              <td mat-cell *matCellDef="let element"> {{element.Fecha_desde_Rec}} </td>
            </ng-container>
            <ng-container matColumnDef="Fecha_hasta_Rec">
              <th mat-header-cell *matHeaderCellDef> Fecha hasta Recibo </th>
              <td mat-cell *matCellDef="let element"> {{element.Fecha_hasta_Rec}}
              </td>
            </ng-container>
            <ng-container matColumnDef="Monto_Rec">
              <th mat-header-cell *matHeaderCellDef> Monto </th>
              <td mat-cell *matCellDef="let element">
                {{element.Monto_Rec}}</td>
            </ng-container>
            <ng-container matColumnDef="Monto_Rec_Ext">
              <th mat-header-cell *matHeaderCellDef> Monto Extranjero </th>
              <td mat-cell *matCellDef="let element">
                {{element.Monto_Rec_Ext}} </td>
            </ng-container>

            <ng-container matColumnDef="Status_Rec">
              <th mat-header-cell *matHeaderCellDef> Estado </th>
              <td mat-cell *matCellDef="let element"> {{element.Status_Rec}}
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="ColumnsRecibos"></tr>
            <tr mat-row *matRowDef="let row; columns: ColumnsRecibos;"></tr>
          </table>
        </div>
        <br>
        <button class="align-right-button" mat-flat-button color="primary" mat-button (click)="stepper.reset()">Inicio</button>
        <button class="align-right-button" mat-flat-button color="warn" mat-button matStepperPrevious>Regresar</button>
      </div>
    </mat-step>
  </mat-stepper>
